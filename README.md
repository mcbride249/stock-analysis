# stock-analysis
#Module 2 Challenge - Stock Analysis Written Analysis Report

1. Overview of Project: Explain the purpose of this analysis. The purpose of this analysis was to determine the yearly stock performance of DAQO New Energy Corp (DQ) for Steve’s parents’ investment portfolio. Steve, wishing to diversify his parents’ investments, also would like to analyze several other green energy stocks to determine their yearly performance in order to provide them with alternative opportunities and to minimize their risk in the event that DQ did not meet their performance expectations. The analysis focused on examining the total number of trades for each company by summing the daily volume of trades for the year and more importantly determining the rate of return for each company in a specified year, by comparing the daily opening and closing price for each company and calculating the overall rate of return for each company for each year.

## 2. Results

Stock Performance As we can see in VBA_Challenge_2017 (https://github.com/mcbride249/stock-analysis/blob/main/Resources/VBA_Challenge_2017.PNG), the price stock performance in general for the year 2017, was overwhelming positive for most green energy stocks, particularly DQ which saw an return rate of almost 200%, perhaps suggesting that a number of initiatives or subsidies may have been in place that was supporting the green energy market, although this cannot be confirmed and is beyond the scope of our knowledge and data set. By 2018 however, we can see that there is an overwhelming decrease in the rate of return for the vast majority of green energy stocks (see VBA_Challenge_2018 (https://github.com/mcbride249/stock-analysis/blob/main/Resources/VBA_Challenge_2018.PNG)), with DQ seeing a decline of 62.6% in their overall performance for the year. Again, while it is beyond our ability to say with certainty, the overall decline in green energy stock performance would suggest that there was a marked decrease in market demand and potentially a slow down of green energy initiatives that could have led to this drop in performance.

Macro Run Times As is evident in the images of the macro run times (1: https://github.com/mcbride249/stock-analysis/blob/main/Resources/VBA_Challenge_2017.PNG, 2: https://github.com/mcbride249/stock-analysis/blob/main/Resources/VBA_Challenge_2018.PNG, 3: https://github.com/mcbride249/stock-analysis/blob/main/Resources/VBA_Challege_2017%20-%20Refactored%20Code.PNG, 4: https://github.com/mcbride249/stock-analysis/blob/main/Resources/VBA_Challege_2018%20-%20Refactored%20Code.PNG), the macro run times differed based on the VBA coding script that was used. The refactored code was, on average between the two years, 25.5% faster than the original non-refactored code. This is because the refactored analysis loops through the ticker array and generates an output (https://github.com/mcbride249/stock-analysis/blob/main/Resources/VBA_Challenge_All_Stock_Analysis_Refactored_Code.png), whereas in the non-refactored code, the loop moves through each ticker individually (https://github.com/mcbride249/stock-analysis/blob/main/Resources/VBA_Challenge_All_Stock_Analysis_Original_Code.png).

## 3.Summary

4. Advantages & Disadvantages of Refactored Code While both codes work, I believe that the refactored code does have several advantages of the non-refactored code. To begin with, the refactored code has shorter run time than the non-refactored code which is due to the use of the array script. The array script limits the number of times the macro needs to “read” the data as opposed to the non-factored code which has the macro continuously loop and “read” the data for each ticker. Similarly, the data in an array is also faster as the array is defined and all the data is kept in specified location which means that any loop does not need to “read” over a large data space for information, cutting down the running time. As mentioned earlier, on average the refactored code was 25.5% faster in comparison to the non-refactored code; while this difference may have meant fractions of seconds of time for this data set, large data sets with more complex problems would have a longer run time, and the reduction of time this time by using more concise code in VBA would improve the user experience and allow them to get their results in amore efficient manner. An extension of this, can be applied here, as by using the array in the refactored code (in this case at least) the VBA code is simplified, allowing other users to understand your code more easily. The disadvantage of the refactored code, however, is that it limits the type of data that can be stored within it and furthermore prevents you form altering the size of how that data is store. Again, while this was not an issue for this project, it could potentially be one if memory size limits is a constraint.

5. Pros and Cons of Refactoring the Original VBA Script The most obvious benefit of the refactored code is that it reduces the run time of the macro. However, the con of the refactored code is the amount of time that one spends creating it. The refactored code in its original form needed to have extensive improvements to it to function, which was in this case, undoubtedly part of the learning exercise. In reality, this could have meant a larger investment time by the data analyst for what was an improvement of around one second. For this data set, the time required to make the refactored code functional was substantially higher than the modicum improvement to the macro run time, making the overall investment in time not worth it.
